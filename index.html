<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>狼人殺</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
      canvas {
        display: block;
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <script>
      let canvas;
      let rectColor = "black";
      let playerNameInput, mcNameInput, submitNameBtn, submitMcBtn, startGameBtn;

      let villagerCheckbox = [];
      let prophetCheckbox, witchCheckbox, hunterCheckbox, guardCheckbox, cupidCheckbox;
      let wolfCheckbox = [];
      let wolfKingCheckbox, whiteWolfCheckbox;

      let playerList = ['Gary', 'Vincent', 'Fei', 'Iris', 'Tony', 'Hersper', 'Zoe', 'Hason', 'Erin', 'Jeffrey', 'Eric', 'Jing', 'Marin', 'Yiu'];
      let gameState = 0;

      function setup() {
        canvas = createCanvas(windowWidth, windowHeight);
        canvas.position(0, 0);
        canvas.style("z-index", "-1");

        // input for landing page
        // gameState = 0
        playerNameInput = createInput();
        playerNameInput.position(width / 2 - playerNameInput.width/2, height * 1/20);

        submitNameBtn = createButton('Add');
        submitNameBtn.position(playerNameInput.x + playerNameInput.width + 10, playerNameInput.y);
        submitNameBtn.mousePressed(addPlayer);

        mcNameInput = createInput();
        mcNameInput.position(width / 2 - mcNameInput.width/2, height * 2/20);

        submitMcBtn = createButton('Add');
        submitMcBtn.position(mcNameInput.x + mcNameInput.width + 10, mcNameInput.y);
        submitMcBtn.mousePressed(removePlayer);

        startGameBtn = createButton('開始');
        startGameBtn.position(width / 2 - startGameBtn.width/2, height * 19/20);

        // input for preparation page
        // gameState = 1
        for (i = 0; i < 10; i++) {
            villagerCheckbox[i] = createCheckbox('廢村', false);
            villagerCheckbox[i].position(30, (i+1) * 30);
            villagerCheckbox[i].hide();
        }

        prophetCheckbox = createCheckbox('預言家', false);
        prophetCheckbox.position(100, 30);
        prophetCheckbox.hide();

        witchCheckbox = createCheckbox('女巫', false);
        witchCheckbox.position(100, 60);
        witchCheckbox.hide();

        hunterCheckbox = createCheckbox('獵人', false);
        hunterCheckbox.position(100, 90);
        hunterCheckbox.hide();

        guardCheckbox = createCheckbox('守衛', false);
        guardCheckbox.position(100, 120);
        guardCheckbox.hide();

        cupidCheckbox = createCheckbox('邱比特', false);
        cupidCheckbox.position(100, 150);
        cupidCheckbox.hide();

        for (i = 0; i < 10; i++) {
            wolfCheckbox[i] = createCheckbox('狼人', false);
            wolfCheckbox[i].position(200, (i+1) * 30);
            wolfCheckbox[i].hide();
        }

        wolfKingCheckbox = createCheckbox('狼王', false);
        wolfKingCheckbox.position(270, 30);
        wolfKingCheckbox.hide();

        whiteWolfCheckbox = createCheckbox('白狼', false);
        whiteWolfCheckbox.position(270, 60);
        whiteWolfCheckbox.hide();
      }

      function draw() {
        background("skyblue");

        textAlign(LEFT)
        text('game state: ' + gameState, 10, 10)
        text('player list: ' + playerList, 10, 20)

        if (gameState == 0) {
            textAlign(RIGHT)
            text('Player: ', playerNameInput.x, playerNameInput.y + playerNameInput.height/2)
            text('MC: ', mcNameInput.x, mcNameInput.y + mcNameInput.height/2)

            // print the player list
            for (i = 0; i < playerList.length; i++) {
                textAlign(CENTER)
                text(playerList[i], width / 2, mcNameInput.y + mcNameInput.height*1.2 + (i+1)*15);
            }
            text('遊玩人數： ' + playerList.length, width / 2, mcNameInput.height*1.2 + (playerList.length+1)*15+70);

            // print the start game button
            startGameBtn.position(width / 2 - startGameBtn.width/2, mcNameInput.height*1.2 + (playerList.length+1)*15+100);
            startGameBtn.mousePressed(startGame)
        } else if (gameState == 1) {
        }
      }

      function windowResized() {
        resizeCanvas(windowWidth, windowHeight);
      }

      function startGame() {
        gameState = 1;

        playerNameInput.remove();
        submitNameBtn.remove();
        startGameBtn.remove();

        for (i = 0; i < villagerCheckbox.length; i++) {
            villagerCheckbox[i].show();
        }

        prophetCheckbox.show();
        witchCheckbox.show();
        hunterCheckbox.show();
        guardCheckbox.show();
        cupidCheckbox.show();

        for (i = 0; i < wolfCheckbox.length; i++) {
            wolfCheckbox[i].show();
        }

        wolfKingCheckbox.show();
        whiteWolfCheckbox.show();

      }

      function addPlayer() {
        let playerName = playerNameInput.value();
        if (playerName !== '') {
            playerList.push(playerName);
            playerNameInput.value('');
        }
      }

      function removePlayer() {
        let mcName = mcNameInput.value();
        playerList.pop(mcName)
        mcNameInput.value('');
      }

      function drawRect() {
        rect(width/2, height/2, 50, 50);
      }
    </script>
  </head>
  <body>
  </body>
</html>
